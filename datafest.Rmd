---
title: "A-super-NOVA Datafest"
output: html_notebook
---

```{r}
library(readr)
library(plyr)
library(stringr)
library(tidyr)
library(dplyr)
library(ggplot2)

datafestdata<-readr::read_csv("/Users/rileyboeth/Downloads/Datafest/dataFestReleaseFinal_3_23.csv")

ggplot(datafestdata, aes(applies))+
  geom_histogram(bins  = 500)

ggplot(datafestdata, aes(clicks))+
  geom_histogram(bins  = 500)


ggplot(datafestdata, aes(descriptionLengthChars))+
  geom_histogram(bins  = 500)

```


```{r}
library(rpart)
library(rpart.plot)
train<-datafestdata%>%
  filter(avgoverallcompanyrating != 0)%>%
  slice(1:891975)

test<-datafestdata%>%
  filter(avgoverallcompanyrating !=0)%>%
  slice(891976:1274249)

#linear regression predicting avgoverallcompanyrating
reg1<-lm(avgoverallcompanyrating~descriptionLengthChars+supervisingJob+noEducationRequirementsJob+highSchoolEducationRequirementsJob+higherEducationRequirementsJob+applies+clicks+employeecount+employerIndustry+admin1, data = train)
summary(reg1)

prediction<-  data.frame(prediction = predict(reg1, newdata = na.omit(test)))
test<-na.omit(test)%>%
  bind_cols(prediction)

test<-test%>%
  select(avgoverallcompanyrating,prediction)%>%
  mutate(difference = avgoverallcompanyrating - prediction)

ggplot(test, aes(difference))+
  geom_histogram(bins= 500)


#ratio of number of jobs in area to number of applicants
ratio<-datafestdata%>%
  group_by(admin1,employerIndustry)%>%
  summarise(num_jobs = n_distinct(jobHash), 
            num_applicants = sum(applies),
            num_clicks = sum(clicks, na.rm=TRUE))%>%
  ungroup()%>%
  mutate(ratio_applications_to_jobs = num_applicants/num_jobs,
         ratio_clicks_to_jobs = num_clicks/num_jobs)
```

